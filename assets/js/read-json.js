(function(){var e,n,a,t;$(".sidebar").mCustomScrollbar({mouseWheel:{deltaFactor:100},autoHideScrollbar:!0}),t="data/",a="general/",e=new Vue({el:"#channelList",data:{channels:[]},methods:{onClick:function(e){return n.channel.name=e.target.innerHTML.slice(1),console.log("channel switched : "+n.channel.name)},onLoad:function(){return n.channel.name=this.channels[0].name,console.log("channel onLoad : "+n.channel.name)},updateChannelList:function(){return $.getJSON(t+"channels.json",function(n){var a,t,s;for(a=0,t=n.length;t>a;a++)s=n[a],e.channels.push(s);return e.onLoad()})}},created:function(){return console.log("channelList created"),this.updateChannelList()}}),n=new Vue({el:"#channelMassages",data:{channel:{name:""},massages:[],massages_updated:[],fileList:[],userData:[]},methods:{updateUserData:function(){var e;if(!(this.userData.length>0))return e=t+"users.json",console.log("load user data : "+e),$.ajax({type:"GET",url:e,async:!1}).done(function(e){return n.$set("userData",e)}),console.log("update user data done")},updateFileList:function(e){var a;return a=t+e+"/filelist.json",console.log("load channel filelist : "+a),$.ajax({type:"GET",url:a,async:!1}).done(function(e){return n.$set("fileList",e)}),console.log("update channel filelist done")},updateChannelMassages:function(e){var a,s,o,l,i,r,u;for(console.log("update channel messages"),console.log("fileList.length : "+this.fileList.length),this.$set("massages_updated",[]),this.massages=[],a=[],u=this.fileList,o=0,l=u.length;l>o;o++)s=u[o],i=t+e+"/"+s,console.log("load json data : "+i),r=$.ajax({type:"GET",url:i,async:!0}).done(function(e){var a,t,s,o,l,i,r,u,c;for(i=[],a=0,s=e.length;s>a;a++)l=e[a],void 0===l.icons&&(void 0===l.user?l.icons={image_48:"assets/icon/dummy.png"}:n.userData.filter(function(e,n){return e.id===l.user?l.icons={image_48:e.profile.image_48}:void 0})),void 0===l.username&&(void 0===l.user?l.username="unknown":n.userData.filter(function(e,n){return e.id===l.user&&void 0!==e.name?l.username=e.name:void 0})),u=String(l.ts).split(".")[0],l.fixedTimestamp=moment.unix(u).format("YYYY/MM/DD hh:mm"),l.textFixed=l.text.replace(/\n/g,"<br>"),void 0!==l.attachment&&(l.attachment.text=l.attachmen.text.replace(/\n/g,"<br>")),i.push(l);for(r=[],t=0,o=i.length;o>t;t++)c=i[t],r.push(n.massages.push(c));return r}),a.push(r);return $.when.apply($,a).done(function(){return n.$set("massages_updated",n.massages)}),console.log("update channel messages done")},onChangeChannel:function(){return a=this.channel.name,this.updateUserData(),this.updateFileList(a),this.updateChannelMassages(a)}},watch:{"channel.name":function(){return this.onChangeChannel()},massages:function(){return console.log("massages updated")}},created:function(){return console.log("channelMassages created")}})}).call(this);